# Prisma å¤šæ–‡ä»¶ Schema é…ç½®ç¸½çµ

## ğŸ“… æ›´æ–°æ—¥æœŸ

2026-01-30

## ğŸ¯ ç›®æ¨™

å°‡ Prisma Schema å¾å–®ä¸€æ–‡ä»¶æ¶æ§‹æ”¹ç‚ºå¤šæ–‡ä»¶æ¶æ§‹ï¼Œå¯¦ç¾æŒ‰é¡åˆ¥ç®¡ç† Modelsã€‚

---

## âœ… å®Œæˆäº‹é …

### 1. é…ç½®æª”æ¡ˆæ›´æ–°

**æ–‡ä»¶ï¼š** `prisma.config.ts`

**è®Šæ›´ï¼š**

```typescript
// ä¿®æ”¹å‰
schema: "prisma/schema.prisma";

// ä¿®æ”¹å¾Œ
schema: "prisma"; // æŒ‡å‘æ•´å€‹ç›®éŒ„
```

**èªªæ˜ï¼š** Prisma 7+ æ”¯æŒå¤šæ–‡ä»¶ Schemaï¼Œåªéœ€æŒ‡å‘åŒ…å«æ‰€æœ‰ `.prisma` æ–‡ä»¶çš„ç›®éŒ„å³å¯ã€‚

---

### 2. Schema æ–‡ä»¶çµæ§‹

```
prisma/
â”œâ”€â”€ schema.prisma              # åŸºç¤é…ç½®ï¼ˆgenerator + datasourceï¼‰
â”œâ”€â”€ migrations/                # Migration æ­·å²
â””â”€â”€ schema/                    # æ¥­å‹™ Modelsï¼ˆæŒ‰é¡åˆ¥åˆ†é¡ï¼‰
    â”œâ”€â”€ student.prisma         # å­¸ç”Ÿç›¸é—œ Models
    â”‚   â”œâ”€â”€ Student           - å­¸ç”Ÿè³‡æ–™
    â”‚   â””â”€â”€ Enrollment        - èª²ç¨‹å ±å
    â””â”€â”€ school.prisma          # å­¸æ ¡ç›¸é—œ Models
        â”œâ”€â”€ School            - å­¸æ ¡è³‡æ–™
        â”œâ”€â”€ Course            - èª²ç¨‹è³‡æ–™
        â”œâ”€â”€ Class             - èª²å ‚å®‰æ’
        â””â”€â”€ Partnership       - åˆä½œé—œä¿‚
```

---

### 3. é—œéµè¦å‰‡

#### âœ… å¿…é ˆéµå®ˆ

- `schema.prisma`ï¼ˆå« generator + datasourceï¼‰å¿…é ˆèˆ‡ `migrations/` åœ¨åŒä¸€å±¤ç´š
- æ‰€æœ‰ `.prisma` æ–‡ä»¶å¿…é ˆåœ¨é…ç½®çš„ç›®éŒ„ç¯„åœå…§ï¼ˆ`prisma/` åŠå…¶å­ç›®éŒ„ï¼‰
- è·¨æ–‡ä»¶çš„ Model é—œè¯å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼ˆä¾‹å¦‚ï¼š`student.prisma` ä¸­çš„ `Enrollment` é—œè¯ `school.prisma` ä¸­çš„ `Course`ï¼‰

#### âŒ ä¸è¦åš

- ä¸è¦å°‡ `schema.prisma` ç§»åˆ°å­ç›®éŒ„
- ä¸è¦å°‡ `migrations/` ç§»åˆ°å…¶ä»–ä½ç½®
- ä¸è¦åœ¨é…ç½®ç›®éŒ„å¤–æ”¾ç½® `.prisma` æ–‡ä»¶

---

### 4. æ•¸æ“šåº«åŒæ­¥

**åŸ·è¡Œå‘½ä»¤ï¼š**

```bash
pnpx prisma db push
```

**çµæœï¼š**

- âœ… è­˜åˆ¥æ‰€æœ‰åˆ†æ‹†çš„ schema æ–‡ä»¶
- âœ… å‰µå»º 6 å€‹ database tablesï¼ˆstudents, enrollments, schools, courses, classes, partnershipsï¼‰
- âœ… è‡ªå‹•ç”Ÿæˆ Prisma Client

---

## ğŸ“ æ“ä½œæµç¨‹ç°¡åŒ–

### ä¿®æ”¹/æ–°å¢/åˆªé™¤ Model

**èˆŠæµç¨‹ï¼ˆ3 æ­¥é©Ÿï¼‰ï¼š**

1. ä¿®æ”¹ `schema.prisma`
2. `pnpx prisma db push`
3. `pnpx prisma generate`

**æ–°æµç¨‹ï¼ˆ2 æ­¥é©Ÿï¼‰ï¼š**

1. ä¿®æ”¹å°æ‡‰çš„ `.prisma` æ–‡ä»¶ï¼ˆ`student.prisma` æˆ– `school.prisma`ï¼‰
2. `pnpx prisma db push`ï¼ˆè‡ªå‹•åŸ·è¡Œ generateï¼‰

**ç¯€çœæ™‚é–“ï¼š** 30-40%

---

## ğŸ¯ å¤šæ–‡ä»¶æ¶æ§‹å„ªå‹¢

### 1. çµæ§‹æ¸…æ™°

- æŒ‰æ¥­å‹™é‚è¼¯åˆ†é¡ï¼ˆå­¸ç”Ÿã€å­¸æ ¡ã€èª²ç¨‹ç­‰ï¼‰
- æ˜“æ–¼æŸ¥æ‰¾å’Œç¶­è­·
- é™ä½èªçŸ¥è² æ“”

### 2. å”ä½œå‹å¥½

- ä¸åŒé–‹ç™¼è€…å¯ä»¥åŒæ™‚ä¿®æ”¹ä¸åŒæ–‡ä»¶
- æ¸›å°‘ Git è¡çª
- Code Review æ›´èšç„¦

### 3. æ“´å±•æ€§å¼·

- æ–°å¢é¡åˆ¥åªéœ€å‰µå»ºæ–°æ–‡ä»¶
- ä¸æœƒè®“å–®ä¸€æ–‡ä»¶éæ–¼é¾å¤§
- 100+ models ä¹Ÿèƒ½è¼•é¬†ç®¡ç†

---

## ğŸ“š ç›¸é—œæ–‡æª”æ›´æ–°

### `PRISMA_QUICK_GUIDE.md`

**ä¸»è¦æ›´æ–°ï¼š**

- âœ… æ‰€æœ‰ç¯„ä¾‹æ”¹ç‚ºå¤šæ–‡ä»¶è·¯å¾‘
- âœ… ç°¡åŒ–æ“ä½œæµç¨‹ï¼ˆ3 æ­¥ â†’2 æ­¥ï¼‰
- âœ… æ–°å¢å¤šæ–‡ä»¶æ¶æ§‹èªªæ˜
- âœ… æ›´æ–°ç•¶å‰ Models æ¸…å–®
- âœ… åŒæ­¥å¯¦éš› Schema é…ç½®ï¼ˆ`@db.Timestamp(6)` ç­‰ï¼‰

**ç§»é™¤ï¼š**

- âŒ éæ™‚çš„å–®ä¸€æ–‡ä»¶ç¯„ä¾‹
- âŒ å¤šé¤˜çš„ `prisma generate` æ­¥é©Ÿ

---

## ğŸš€ å¾ŒçºŒå»ºè­°

### 1. æŒçºŒå„ªåŒ–åˆ†é¡

ç•¶ Models æ•¸é‡å¢åŠ æ™‚ï¼Œå¯ä»¥è€ƒæ…®æ›´ç´°ç·»çš„åˆ†é¡ï¼š

```
prisma/schema/
â”œâ”€â”€ student/
â”‚   â”œâ”€â”€ student.prisma
â”‚   â””â”€â”€ enrollment.prisma
â”œâ”€â”€ school/
â”‚   â”œâ”€â”€ school.prisma
â”‚   â””â”€â”€ partnership.prisma
â””â”€â”€ course/
    â”œâ”€â”€ course.prisma
    â””â”€â”€ class.prisma
```

### 2. å»ºç«‹å‘½åè¦ç¯„

- æ–‡ä»¶åä½¿ç”¨å°å¯« + é€£å­—ç¬¦ï¼ˆå¦‚ `student-grade.prisma`ï¼‰
- æˆ–ä½¿ç”¨å°é§å³°ï¼ˆå¦‚ `studentGrade.prisma`ï¼‰
- åœ˜éšŠçµ±ä¸€å³å¯

### 3. å®šæœŸæ•´ç†

- åˆªé™¤æœªä½¿ç”¨çš„ Models
- åˆä½µéæ–¼é›¶æ•£çš„æ–‡ä»¶
- ä¿æŒæ¯å€‹æ–‡ä»¶ 50-200 è¡Œç‚ºä½³

---

## ğŸ“Œ å¿«é€Ÿåƒè€ƒ

### æ–°å¢ Model

```bash
# 1. åœ¨å°æ‡‰çš„ .prisma æ–‡ä»¶æ–°å¢ model å®šç¾©
# 2. pnpx prisma db push
```

### ä¿®æ”¹ Model

```bash
# 1. ä¿®æ”¹å°æ‡‰çš„ .prisma æ–‡ä»¶
# 2. pnpx prisma db push
```

### åˆªé™¤ Model

```bash
# 1. å¾å°æ‡‰çš„ .prisma æ–‡ä»¶ç§»é™¤ model
# 2. pnpx prisma db push
```

### æŸ¥çœ‹æ•¸æ“š

```bash
pnpx prisma studio
```

### æ ¼å¼åŒ– Schema

```bash
pnpx prisma format  # æ ¼å¼åŒ–æ‰€æœ‰ .prisma æ–‡ä»¶
```

---

## âœ… ç¸½çµ

ä½ çš„ Prisma ç³»çµ±ç¾åœ¨ä½¿ç”¨**å¤šæ–‡ä»¶æ¶æ§‹**ï¼Œäº«æœ‰ä»¥ä¸‹å„ªå‹¢ï¼š

- ğŸ¯ **çµæ§‹æ¸…æ™°** - Models æŒ‰æ¥­å‹™é‚è¼¯åˆ†é¡
- ğŸš€ **æ“ä½œç°¡åŒ–** - åªéœ€ 2 æ­¥é©Ÿå®Œæˆä¿®æ”¹
- ğŸ¤ **å”ä½œå‹å¥½** - æ¸›å°‘ Git è¡çª
- ğŸ“ˆ **æ˜“æ–¼æ“´å±•** - æ”¯æŒå¤§å‹å°ˆæ¡ˆ

**æ ¸å¿ƒé…ç½®ï¼š**

- `prisma.config.ts` â†’ `schema: "prisma"`
- `prisma/schema.prisma` â†’ åŸºç¤é…ç½®
- `prisma/schema/*.prisma` â†’ æ¥­å‹™ Models

**æ—¥å¸¸æ“ä½œï¼š**

1. ä¿®æ”¹å°æ‡‰çš„ `.prisma` æ–‡ä»¶
2. `pnpx prisma db push`

å°±é€™éº¼ç°¡å–®ï¼ğŸ‰

---

**æ–‡æª”ç‰ˆæœ¬ï¼š** 1.0  
**æœ€å¾Œæ›´æ–°ï¼š** 2026-01-30  
**ç³»çµ±ï¼š** Prisma ORM v7.3.0  
**ç‹€æ…‹ï¼š** âœ… ç”Ÿç”¢ç’°å¢ƒå¯ç”¨
