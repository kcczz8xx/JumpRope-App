# 新增課程功能 - 開發指南總覽

## 功能簡介

本功能實現了一個多步驟表單，用於創建學校課程資料，包含學校基本資料、聯絡人資料和課程資料的完整建立流程。

## 核心特點

- ✅ **多步驟表單**：三步驟流程（學校資料 → 課程資料 → 總結確認）
- ✅ **資料驗證**：每個步驟都有完整的前端驗證
- ✅ **資料庫交易**：使用 Prisma Transaction 確保資料一致性
- ✅ **支援新增/更新**：可選擇現有學校或創建新學校
- ✅ **多課程支援**：一次可建立多個課程
- ✅ **複雜收費模式**：支援 6 種不同的收費模式組合

## 技術架構

### 前端架構

```
app/(private)/dashboard/school/courses/new/
└── page.tsx (頁面入口)
    └── NewCourseForm (主表單元件)
        ├── SchoolFormStep (步驟 1：學校資料)
        ├── CoursesFormStep (步驟 2：課程資料)
        └── SummaryFormStep (步驟 3：總結確認)
```

### 後端架構

```
app/api/school-service/courses/batch-with-school/
└── route.ts (API Route Handler)
    └── Prisma Transaction
        ├── 處理學校資料 (新增/更新)
        ├── 處理聯絡人資料 (新增/更新)
        └── 批次建立課程
```

### 資料流

```
頁面載入
  ↓
載入學校列表 (可選)
  ↓
使用者填寫表單 (步驟 1-3)
  ↓
前端驗證
  ↓
提交至 API Route
  ↓
Prisma Transaction 處理
  ↓
返回結果 & 跳轉頁面
```

## 文檔結構

本開發指南分為以下文件：

1. **[01\_總覽.md](./01_總覽.md)** - 本文件，功能總覽與架構說明
2. **[02\_頁面與路由.md](./02_頁面與路由.md)** - 頁面結構與路由設計
3. **[03\_類型定義.md](./03_類型定義.md)** - TypeScript 類型系統
4. **[04\_表單元件.md](./04_表單元件.md)** - 表單元件實作細節
5. **[05\_狀態管理.md](./05_狀態管理.md)** - 狀態管理與驗證邏輯
6. **[06_API_Route.md](./06_API_Route.md)** - API Route 實作
7. **[07\_資料庫操作.md](./07_資料庫操作.md)** - Prisma 資料庫操作
8. **[08\_錯誤處理.md](./08_錯誤處理.md)** - 錯誤處理與使用者體驗
9. **[09\_最佳實踐.md](./09_最佳實踐.md)** - 設計決策與最佳實踐

## 關鍵檔案路徑

### 前端元件

- `app/(private)/dashboard/school/courses/new/page.tsx` - 頁面入口
- `components/feature/school-service/course/NewCourseForm.tsx` - 主表單元件
- `components/feature/school-service/course/SchoolFormStep.tsx` - 學校資料步驟
- `components/feature/school-service/course/CoursesFormStep.tsx` - 課程資料步驟
- `components/feature/school-service/course/SummaryFormStep.tsx` - 總結步驟
- `components/feature/school-service/course/index.ts` - 元件匯出

### 類型定義

- `components/feature/school-service/types/course.ts` - 課程相關類型定義

### 後端 API

- `app/api/school-service/courses/batch-with-school/route.ts` - 批次建立 API

### 資料庫 Schema

- `prisma/schema/school.prisma` - 學校服務資料庫 Schema

## 快速開始

### 1. 安裝依賴

```bash
pnpm install
```

### 2. 設定環境變量

```bash
# .env
DATABASE_URL="postgresql://..."
NEXT_PUBLIC_APP_URL="http://localhost:3000"
```

### 3. 執行資料庫遷移

```bash
pnpm prisma migrate dev
pnpm prisma generate
```

### 4. 啟動開發伺服器

```bash
pnpm dev
```

### 5. 訪問頁面

```
http://localhost:3000/dashboard/school/courses/new
```

## 下一步

請依序閱讀以下文檔以深入了解各個部分的實作細節：

1. 從 **[02\_頁面與路由.md](./02_頁面與路由.md)** 開始了解頁面結構
2. 閱讀 **[03\_類型定義.md](./03_類型定義.md)** 了解資料結構
3. 深入 **[04\_表單元件.md](./04_表單元件.md)** 學習元件實作
4. 參考 **[09\_最佳實踐.md](./09_最佳實踐.md)** 了解設計決策
