generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Class {
  id        String   @id @default(dbgenerated("(gen_random_uuid())::text"))
  courseId  String   @map("course_id")
  date      DateTime @db.Timestamp(6)
  startTime String   @map("start_time")
  endTime   String   @map("end_time")
  location  String?
  capacity  Int?
  status    String?  @default("scheduled")
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt DateTime @default(now()) @map("updated_at") @db.Timestamp(6)
  
  course Course @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@map("classes")
}

model Course {
  id          String      @id @default(dbgenerated("(gen_random_uuid())::text"))
  schoolId    String      @map("school_id")
  name        String
  description String?
  courseType  String?     @map("course_type")
  duration    Int?
  fee         Decimal?    @db.Decimal(10, 2)
  status      String?     @default("active")
  createdAt   DateTime    @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt   DateTime    @default(now()) @map("updated_at") @db.Timestamp(6)
  
  school      School      @relation(fields: [schoolId], references: [id], onDelete: Cascade)
  classes     Class[]
  enrollments Enrollment[]

  @@map("courses")
}

model Enrollment {
  id        String   @id @default(dbgenerated("(gen_random_uuid())::text"))
  studentId String   @map("student_id")
  courseId  String   @map("course_id")
  status    String?  @default("active")
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt DateTime @default(now()) @map("updated_at") @db.Timestamp(6)
  
  student Student @relation(fields: [studentId], references: [id], onDelete: Cascade)
  course  Course  @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@unique([studentId, courseId])
  @@map("enrollments")
}

model Partnership {
  id            String    @id @default(dbgenerated("(gen_random_uuid())::text"))
  schoolId      String?   @map("school_id")
  schoolName    String    @map("school_name")
  schoolAddress String    @map("school_address")
  schoolTel     String?   @map("school_tel")
  contactPerson String?   @map("contact_person")
  contactTitle  String?   @map("contact_title")
  contactTel    String?   @map("contact_tel")
  contactEmail  String?   @map("contact_email")
  startDate     DateTime  @map("start_date") @db.Timestamp(6)
  endDate       DateTime? @map("end_date") @db.Timestamp(6)
  status        String?   @default("active")
  createdAt     DateTime  @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt     DateTime  @default(now()) @map("updated_at") @db.Timestamp(6)
  
  school School? @relation(fields: [schoolId], references: [id], onDelete: Cascade)

  @@map("partnerships")
}

model School {
  id           String        @id @default(dbgenerated("(gen_random_uuid())::text"))
  name         String
  address      String?
  tel          String?
  email        String?
  status       String?       @default("active")
  createdAt    DateTime      @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt    DateTime      @default(now()) @map("updated_at") @db.Timestamp(6)
  
  courses      Course[]
  partnerships Partnership[]

  @@map("schools")
}

model Student {
  id          String       @id @default(dbgenerated("(gen_random_uuid())::text"))
  name        String
  email       String       @unique
  phone       String?
  age         Int?
  level       String?      @default("beginner")
  createdAt   DateTime     @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt   DateTime     @default(now()) @map("updated_at") @db.Timestamp(6)
  
  enrollments Enrollment[]

  @@map("students")
}
