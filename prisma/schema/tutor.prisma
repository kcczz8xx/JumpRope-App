// ============================================
// 導師模組 - Tutor Management
// ============================================

/// 導師資料
model TutorProfile {
  id String @id @default(cuid())

  userId String @unique
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  // 導師資格
  specialties String[] // 專長（個人花式/速度跳/團體等）

  // 薪資設定
  defaultSalaryMode   SalaryCalculationMode @default(PER_LESSON) // 預設薪資計算方式
  defaultPerLessonFee Decimal?              @db.Decimal(10, 2) // 預設每堂薪資
  defaultHourlyRate   Decimal?              @db.Decimal(10, 2) // 預設時薪
  monthlyFixedSalary  Decimal?              @db.Decimal(10, 2) // 固定月薪

  // 關聯文件
  documents TutorDocument[] // 導師文件（一對多）

  // 狀態
  isActive   Boolean   @default(true)
  approvedAt DateTime? // 審核通過日期
  approvedBy String? // 審核人員 ID

  // 備註
  remarks String? @db.Text

  // 系統欄位
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  @@index([userId])
  @@index([isActive])
  @@map("tutor_profiles")
}

// ============================================
// 導師文件 - Tutor Documents
// ============================================

enum DocumentStatus {
  VALID // 有效
  EXPIRED // 已過期
  EXPIRING_SOON // 即將過期（30天內）
  PENDING // 審核中
  NOT_SUBMITTED // 未提交
}

enum DocumentType {
  SEXUAL_CONVICTION_CHECK // 性罪行定罪紀錄查核
  FIRST_AID_CERTIFICATE // 急救證書
  IDENTITY_DOCUMENT // 身份證明文件
  COACHING_CERTIFICATE // 教練證書
  OTHER_CERTIFICATE // 其他證書
}

model TutorDocument {
  id String @id @default(cuid())

  tutorProfileId String
  tutorProfile   TutorProfile @relation(fields: [tutorProfileId], references: [id], onDelete: Cascade)

  // 文件類型與名稱
  documentType DocumentType // 文件類型
  name         String // 文件名稱（e.g. "花式跳繩教練證書（一級）"）

  // 狀態
  status DocumentStatus @default(NOT_SUBMITTED)

  // 文件詳情
  referenceNumber String? // 參考編號（性罪行查核用）
  certificateType String? // 證書類型（急救證書用）
  issuingBody     String? // 簽發機構
  issueDate       DateTime? // 簽發日期
  expiryDate      DateTime? // 到期日期（null = 永久有效）

  // 文件存儲
  documentUrl String? // 文件 URL
  uploadDate  DateTime? // 上傳日期

  // 審核
  reviewedAt DateTime? // 審核日期
  reviewedBy String? // 審核人員 ID
  reviewNote String? @db.Text // 審核備註

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([tutorProfileId])
  @@index([documentType])
  @@index([status])
  @@map("tutor_documents")
}
