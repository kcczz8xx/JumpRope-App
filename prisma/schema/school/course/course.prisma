// ============================================
// 到校服務模組 - 課程
// ============================================

/// 到校課程
model SchoolCourse {
  id String @id @default(cuid())

  schoolId String
  school   School @relation(fields: [schoolId], references: [id], onDelete: Cascade)

  // 課程基本資料
  courseName  String
  courseCode  String?
  courseType  String
  description String? @db.Text

  // 學期設定
  courseTerm   CourseTerm @default(FULL_YEAR)
  academicYear String

  // 課程時間（可選，資料可能延遲補充）
  startDate DateTime?
  endDate   DateTime?

  // 人數設定
  requiredTutors Int  @default(1)
  maxStudents    Int?

  // 課程狀態
  status CourseStatus @default(DRAFT)

  // 資料完整度管理
  dataCompleteness       Json? // { "basicInfo": true, "feeStructure": true, "schedule": false }
  pendingDataFields      String[]  @default([]) // ["schedule", "maxStudents"]
  dataCompletionDeadline DateTime?

  // 付款模式
  paymentMode String?

  // 備註
  remarks String? @db.Text

  // 關聯
  feeStructures SchoolCourseFeeStructure[]
  schedules     SchoolCourseSchedule[]
  lessons       SchoolLesson[]
  invoiceItems  SchoolInvoiceItem[]

  // 系統欄位
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  @@index([schoolId])
  @@index([academicYear])
  @@index([courseType])
  @@index([status])
  @@map("school_courses")
}
